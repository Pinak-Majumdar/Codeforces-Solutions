This problem is a direct generalization of 2171C1.
The game rules and core logic remain unchanged; the only difference is that the array values are no longer restricted to binary values (0 and 1).
As a result, the same parity-based observation and solution approach from C1 applies here.